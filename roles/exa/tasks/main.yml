- name: Find executable.
  search_file:
    name: exa
    paths:
      - /opt/homebrew/bin
      - /usr/bin
    executable: true
  register: exa_check
    
- name: Store path.
  ansible.builtin.set_fact:
    exa_path: "{{ exa_check.path }}"
  when: exa_check.found

- name: Alias ls to exa.
  ansible.builtin.set_fact:
    aliases: "{{ aliases + [['ls', exa_path], ['ll', exa_path + ' --long --icons']] }}"
  when: exa_path is defined

- name: Change defaults for ls.
  ansible.builtin.set_fact:
    aliases: "{{ aliases + [['ls', 'ls --color=auto'], ['ll', 'ls --color=auto -lh']] }}"
  when: not (exa_path is defined)
